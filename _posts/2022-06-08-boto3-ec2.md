---
layout:     post
title:   "Managing EC2 Instances Using Boto3"
date:       2022-02-14 15:13:18 +0200
image: pbec2.webp
tags:
    - Boto3
    - AWS
categories: Boto3
---

á€€á€»á€½á€”á€ºá€á€±á€¬á€ºá€’á€®á€”á€±á€·á€™á€¾á€¬á€á€±á€¬á€· Boto3 á€€á€­á€¯á€á€¯á€¶á€¸á€•á€¼á€®á€¸ EC2 instances á€á€½á€±á€€á€­á€¯ manage á€œá€¯á€•á€ºá€á€²á€·á€¡á€€á€¼á€±á€¬á€„á€ºá€¸á€›á€¾á€„á€ºá€¸á€•á€¼á€•á€«á€™á€šá€ºá‹ Boto3 á€†á€­á€¯á€á€¬ AWS service á€á€½á€±á€¡á€á€½á€€á€ºá€¡á€á€¯á€¶á€¸á€•á€¼á€¯á€™á€šá€ºá€· Python SDK á€–á€¼á€…á€ºá€•á€«á€á€šá€ºá‹ 

ğŸ‘‰ Install Boto3

Boto3 á€€á€­á€¯ install á€œá€¯á€•á€ºá€–á€­á€¯á€·á€¡á€á€½á€€á€º á€¡á€±á€¬á€€á€ºá€•á€«á€¡á€á€­á€¯á€„á€ºá€¸ á€•á€¼á€¯á€œá€¯á€•á€ºá€”á€­á€¯á€„á€ºá€•á€«á€á€šá€ºá‹

```bash
$ pip3 install boto3 
```
ğŸ‘‰ Configure AWS Credentials

á€•á€¼á€®á€¸á€á€½á€¬á€¸á€›á€„á€ºá€á€±á€¬á€· aws configure á€”á€²á€· aws access key á€”á€²á€· secret key á€á€½á€±á€€á€­á€¯ á€á€á€ºá€™á€¾á€á€ºá€•á€±á€¸á€›á€•á€«á€™á€šá€ºá‹ 

```bash
$ aws configure
```
á€¡á€²á€·á€œá€­á€¯á€™á€á€á€ºá€™á€¾á€á€ºá€•á€±á€¸á€–á€°á€¸á€†á€­á€¯á€›á€„á€º boto3 session á€™á€¾á€¬ access key á€”á€²á€· secret key á€€á€­á€¯ parameter á€á€½á€±á€¡á€–á€¼á€…á€ºá€€á€¼á€±á€Šá€¬á€•á€±á€¸á€›á€•á€«á€™á€šá€ºá‹

```bash
import boto3

session = boto3.Session(
    aws_access_key_id=ACCESS_KEY,
    aws_secret_access_key=SECRET_KEY,
    aws_session_token=SESSION_TOKEN
)
```

ğŸ‘‰ Creating EC2 instance

á€•á€‘á€™á€†á€¯á€¶á€¸á€¡á€”á€±á€”á€²á€· EC2 instance á€á€½á€±á€€á€­á€¯ create á€œá€¯á€•á€ºá€–á€­á€¯á€·á€¡á€á€½á€€á€º EC2 resource á€‘á€²á€€ create_instances() method á€€á€­á€¯á€á€¯á€¶á€¸á€•á€«á€™á€šá€ºá‹ 

```bash
#!/usr/bin/env python3

import boto3

EC2_RESOURCE = boto3.resource('ec2', region_name='us-east-1')

instances = EC2_RESOURCE.create_instances(
    MinCount = 1,
    MaxCount = 2,
    ImageId='ami-09d56f8956ab235b3',
    InstanceType='t2.micro',
    SecurityGroupIds=[
        'sg-0f1df0f49a700cd6a',
    ],
    SubnetId='subnet-06a1d2785fbf61317',
    TagSpecifications=[
        {
            'ResourceType': 'instance',
            'Tags': [
                {
                    'Key': 'Name',
                    'Value': 'ec2-boto3'
                },
            ]
        },
    ]
)

for instance in instances:
    print(f'EC2 instance "{instance.id}" has been launched')
    
    instance.wait_until_running()
```    
create_instances() method á€‘á€²á€™á€¾á€¬ á€á€¯á€¶á€¸á€‘á€¬á€¸á€á€²á€· parameters á€á€½á€±á€€á€­á€¯á€›á€¾á€„á€ºá€¸á€•á€¼á€•á€«á€™á€šá€ºá‹

<ul>
    <li> MinCount - launch á€œá€¯á€•á€ºá€™á€šá€ºá€· á€¡á€”á€Šá€ºá€¸á€†á€¯á€¶á€¸ EC2 á€•á€™á€¬á€á€–á€¼á€…á€ºá€•á€«á€á€šá€ºá‹</li>
    <li> MaxCount - launch á€œá€¯á€•á€ºá€™á€šá€ºá€· á€¡á€™á€»á€¬á€¸á€†á€¯á€¶á€¸ EC2 á€•á€™á€¬á€á€–á€¼á€…á€ºá€•á€«á€á€šá€ºá‹</li>
    <li> ImageId - á€€á€­á€¯á€šá€ºá€á€¯á€¶á€¸á€™á€šá€ºá€· AMI ID á€–á€¼á€…á€ºá€•á€«á€á€šá€ºá‹</li>
    <li> SubentId - EC2 instance á€‘á€¬á€¸á€™á€šá€ºá€· subnet á€›á€²á€· ID á€–á€¼á€…á€ºá€•á€«á€á€šá€ºá‹</li>
    <li> InstanceType - Instance á€›á€²á€· type á€¡á€™á€»á€­á€¯á€¸á€¡á€…á€¬á€¸á€–á€¼á€…á€ºá€•á€«á€á€šá€ºá‹ </li>
    <li> SecurityGroupIds = Instance á€¡á€á€½á€€á€º á€œá€­á€¯á€¡á€•á€ºá€á€²á€· security group á€á€½á€±á€á€»á€­á€á€ºá€•á€±á€¸á€–á€­á€¯á€·á€•á€«á‹</li>
</ul>

ğŸ‘‰ EC2 Waiters

á€’á€®á€”á€±á€›á€¬á€™á€¾á€¬ EC2 waiter á€á€½á€±á€‘á€²á€€á€á€…á€ºá€á€¯á€–á€¼á€…á€ºá€á€²á€· wait_until_running() á€€á€­á€¯á€á€¯á€¶á€¸á€‘á€¬á€¸á€•á€«á€á€šá€ºá‹ á€†á€­á€¯á€œá€­á€¯á€›á€„á€ºá€¸á€€á€á€±á€¬á€· instance á€á€…á€ºá€á€¯ running á€™á€–á€¼á€…á€ºá€™á€á€¼á€„á€ºá€¸ waiting á€œá€¯á€•á€ºá€”á€±á€™á€¾á€¬á€•á€«á‹ á€•á€¼á€®á€¸á€á€½á€¬á€¸á€™á€¾ á€”á€±á€¬á€€á€º instance á€á€…á€ºá€á€¯á€€á€­á€¯ loop á€€á€”á€± create á€†á€€á€ºá€œá€¯á€•á€ºá€á€½á€¬á€¸á€™á€šá€ºá€œá€­á€¯á€·á€•á€¼á€±á€¬á€á€¬á€•á€«á‹

á€¡á€¬á€¸á€œá€¯á€¶á€¸á€•á€¼á€®á€¸á€á€½á€¬á€¸á€›á€„á€ºá€á€±á€¬á€· code á€€á€­á€¯ run á€œá€­á€¯á€€á€ºá€›á€„á€º á€¡á€±á€¬á€€á€ºá€€á€¡á€á€­á€¯á€„á€ºá€¸ instance (á‚)á€á€¯ á€›á€œá€¬á€•á€«á€œá€­á€™á€ºá€·á€™á€šá€ºá‹

```bash
% python3 6_ec2_create.py
EC2 instance "i-0f3465727b9b0f3e8" has been launched
EC2 instance "i-06f0dd0e1ade9fb79" has been launched
```
